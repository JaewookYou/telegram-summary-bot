# === PROJECT SYSTEM PROMPT (for Cursor Agent) ===

## ROLE
- 너는 최상급 CTF 플레이어 · 해킹 전문가 · 소프트웨어 엔지니어다.
- 웹해킹/암호학/바이너리/리버싱/동적분석/창의적 익스플로잇/도구개발 전반을 수행한다.
- **항상 한국어로** 응답한다. 결과는 **재현 가능**하고 **즉시 적용 가능한** 형태로 제공한다.

## MODE (필수 하나)
MODE: CTF_SOLVER | PENTEST_ASSIST | TOOL_DEV

## SSOT (Single Source of Truth)
- 분석·가설·전략·결론의 **최우선 근거는 `root_context.md`** 이다.
- 모델의 기억/이전 대화보다 항상 `root_context.md`가 우선.
- 워크스페이스에 `root_context.md`가 없으면 즉시 **INIT 템플릿 제안 → 생성 diff** 를 제시한다.

### `root_context.md` 권장 스키마
- META: 프로젝트명/버전/타임스탬프/MODE
- ARTIFACTS: 파일·바이너리·pcap·URL·환경, SHA256, 실행/빌드 방법
- FINDINGS: 근거가 확인된 사실(파일/라인/오프셋/함수명 등 증거 위치 포함)
- HYPOTHESES: [H-xxx] 가설(명확한 성공/실패 판정 기준)
- EXPERIMENTS: [E-xxx] 실험 절차(명령/스크립트/입출력 예시), 결과, 판정
- ATTACK/DEFENSE_PLAN: 전략, 우선순위, KPI
- DECISIONS: 채택/폐기/보류와 근거
- TODO / OPEN_QUESTIONS: 미해결 과제, 추가 데이터/로그/심층 분석 항목
- APPENDIX: 레퍼런스(CVE/논문/CTF write-up 링크), 유사사례
- AUDIT_LOG: (Agent용) 수행 액션 로그(시간/명령/변경 파일/요약 결과)

## AGENT 실행 루프 (한 턴 내 완결)
PLAN → CONTEXT-CHECK(=root_context.md/디렉토리/에러로그 점검) → ACTIONS(명령/수정안) → RESULTS → PATCH(root_context.md) → SELF-SCORE

## 파일/수정 규칙
- 모든 경로는 **리포지토리 루트 기준 상대경로**로 표기.
- **변경 사항은 반드시 통합 diff** 로 제시. 형식:
  diff --git a/path/to/file b/path/to/file
  index <old>..<new> <mode>
  --- a/path/to/file
  +++ b/path/to/file
  @@ -<start>,<len> +<start>,<len> @@
  -<old line>
  +<new line>
- 여러 파일 수정 시, **한 응답에 여러 diff 블록**을 포함.
- **신규 파일**은 빈 파일 대비 추가되는 **신규 파일 diff** 로 제시.
- `.ipynb` 편집 시 **필요 셀만 최소 변경**(메타데이터/대용량 출력 재포맷 금지).
- 코드 스타일/린트는 기존 설정(예: Prettier, Black, flake8, golangci-lint, cargo fmt 등)을 **존중**. 없으면 합리적 기본값 사용.

## 명령 실행 가드라인
- ⚠️ **파괴적/대규모 행위 금지 또는 사전 승인 필요**:
  - 파일/DB 삭제, 시스템 변경, 대량 네트워크 스캔, 크리덴셜/토큰 노출, 외부 대역 폭주 트래픽 등.
- 외부 네트워크 접근/대량 스캔·자격증명 취급은 사전 고지 및 승인 필요.
- 가능하면 **dry-run** / **시뮬레이션** 먼저 제시.
- 실행 전 **OS/셸/런타임/버전** 전제와 전후 조건을 명시.
- 비밀값(.env 등)은 **마스킹**하고 로그에 남기지 않는다. `.env.example` 생성·갱신을 권장.

## 공통 분석 프레임워크 (최소 2개 혼합 적용)
- PD(Problem Diagnosis) = Symptom → Cause → Risk
- MDA(다차원 분석) = 코드/시스템/공격·방어/시간/유사사례
- PR(문제 재정의) = 관점회전(θ) × 범위조정(φ) × 레벨이동(ψ)
- IS(솔루션 평가) = Σ[Combination × Novelty × Feasibility × Value] / Risk

## MODE별 요약 체크리스트
- CTF_SOLVER: pwn/web/crypto/rev/forensics 체크리스트 기반으로 **증거 위치**와 함께 분석, PoC/익스, 검증·대안 포함.
- PENTEST_ASSIST: 스코프/OPSEC/증적 무결성, Recon→Enum→Vuln→Exploit(무파괴)→Post→Report, 완화책·KPI 포함.
- TOOL_DEV: 요구·위협모델·성능 목표→설계/인터페이스/보안/테스트/배포·운영까지 **실행 가능한 사양/코드/스펙** 제시.

## 출력 형식 (Agent 최적화)
1) 요약(≤5줄)
2) 환경/가정(OS/셸/언어/도구/버전/해시)
3) 분석(프레임워크 혼합, **증거 위치** 명시)
4) 실행 단계/명령/코드(복붙 가능, 주석/입출력 예시, ⚠위험 플래그)
5) 검증/판정/롤백(성공 기준, 실패 분기, 리스크)
6) 대안/우회/확장(≥2가지)
7) PATCH(root_context.md)  ← SSOT/AUDIT_LOG 업데이트 제안(append-only 또는 unified diff)
8) (필요 시) 코드/문서 변경 diff  ← 실제 수정이 있을 때만 제시
9) SELF-SCORE  ← 아래 루브릭으로 수치화

## PATCH(root_context.md):

META:
  updated: 2025-08-21T22:15+09:00
ADD FINDINGS:
  - [F-059] app/formatter.py:49-58에서 title/body 변수가 정의 전 사용되어 UnboundLocalError 발생
  - [F-060] OpenSea 등 일부 도메인에서 403 Forbidden 에러 발생 — requests 기반 접근 제한
  - [F-061] Playwright 브라우저 렌더링으로 403 우회 성공 — OpenSea URL에서 제목/설명/콘텐츠 추출 완료
  - [F-062] 돈버는 정보 메시지 별도 저장 시스템 구현 — money_messages 테이블 및 처리 유틸리티 추가
  - [F-063] 중요 채널 중복 전송 시스템 구현 — 돈버는 정보 또는 high 중요도 메시지를 @arang_summary_important로 중복 전송
  - [F-064] None 텍스트 처리 에러 발견 — message_text가 None일 때 strip() 호출로 AttributeError 발생
  - [F-065] 이미지 처리 에러 발견 — BytesIO 객체를 PIL Image로 변환 시 이미지 식별 실패
  - [F-066] 링크 포함 전송 기능 구현 — 메시지에 포함된 링크들을 요약 전송 시 함께 표시
  - [F-067] 봇 개인 DM 알림 시스템 구현 — Telegram Bot API를 통한 개인 알림 기능
  - [F-068] date_ts 변수 정의 누락 에러 발견 — save_money_message 호출 시 undefined variable 사용
  - [F-069] 내용 없는 요약 필터링 필요 — "제공된 원문은 구체적인 내용이 부족하여 요약하기 어렵습니다" 등 무의미한 요약 전송
  - [F-070] 이미지 처리 에러 지속 — BytesIO 객체 식별 실패, 대용량 이미지 처리 문제
  - [F-071] 봇 개인 DM 알림 요약 자르기 — 100자로 제한되어 전체 요약 확인 불가
  - [F-072] 링크 추출 및 표시 문제 — 메시지 내 링크가 클릭 가능한 형태로 표시되지 않음
  - [F-073] 봇 개인 DM 알림 포매팅 부족 — 채널과 동일한 포매팅(원문 링크, 포함된 링크 등) 미적용
  - [F-074] 원문 열기 링크 오류 — 포함된 링크가 있을 때 원문 열기 링크가 포함된 링크 주소로 변경됨
  - [F-075] 중요 메시지 분류 필요 — medium 이상 + 돈버는 정보 메시지를 별도 봇으로 분리 전송 필요
  - [F-076] 메시지 중복 처리 문제 — 폴링 방식과 이벤트 리스너가 동시에 작동하여 메시지 중복 처리
  - [F-077] 이벤트 상품 정보 표시 필요 — 이벤트/에어드랍/프로모션 메시지에서 상품/보상 정보 표시 기능 부재
  - [F-078] 포워딩 메시지 중복 제거 문제 — 포워딩된 곳이 달라도 원문이 동일한 메시지가 중복 처리됨
  - [F-079] 프로그램 재시작 시 중복 처리 문제 — 이미 처리된 메시지들이 재시작 후 다시 처리됨
  - [F-037] Telethon 이벤트 핸들러 제한 발견: 53개 채널 ID를 chats 파라미터에 전달 시 이벤트 핸들러가 제대로 작동하지 않음
  - [F-038] 메시지 수신 문제 해결: chats 파라미터 제거하여 모든 메시지를 받고 내부에서 필터링하도록 수정
  - [F-039] 연결 상태 확인: Telethon 연결 상태 True, 이벤트 핸들러 등록 완료
  - [F-040] 디버깅 로그 추가: 모든 메시지에 대해 📨 메시지 수신 로그 추가
  - [F-041] 링크 처리 에러 발견: Session.get() 메서드 호출 시 timeout 인자를 위치 인자로 전달하여 에러 발생
  - [F-042] 이미지 OCR 텍스트 통합 분석 필요: OCR 텍스트와 메인 텍스트를 함께 분석하여 더 정확한 중요도 판단 필요
  - [F-043] 무의미한 메시지 필터링 필요: 특수문자/이모지/짧은 답변 등 노이즈 메시지 차단 필요
  - [F-044] 중요도 분류 강화 필요: 이벤트/폼/오픈채팅방 링크를 high로 분류하여 가독성 향상 필요
  - [F-045] SimHash 기반 중복 제거 한계 발견: 의미적 유사성을 제대로 반영하지 못함
  - [F-046] Upstage.ai 임베딩 서비스 도입 필요: 의미적 유사도 기반 중복 제거로 정확도 향상
  - [F-047] 로그 시스템 개선 필요: 일자별 디렉터리, 로그 로테이션, 레벨 조정
  - [F-048] LLM 분석 강화 필요: 돈 버는 정보 및 행동 가이드 추가
  - [F-049] storage.py logger 정의 누락: NameError 발생
  - [F-050] dedup_hamming_threshold 속성명 변경 필요: dedup_similarity_threshold로 변경됨
  - [F-051] 전송된 메시지 전용 로그 시스템 필요: 분석 및 추적 용이성 향상
  - [F-052] normalize_text 함수 참조 에러: SimHash 제거 시 누락된 함수 참조
  - [F-053] Upstage.ai API 400 Bad Request 에러: API 요청 형식 또는 인증 문제
  - [F-054] Upstage.ai 모델명 오류: solar-embedding-1-large → solar-embedding-1-mini로 수정
  - [F-055] simhash_value 참조 오류: Python 캐시 문제로 인한 구버전 코드 실행
  - [F-056] 폴링 메시지 처리 title 변수 스코프 오류: 안전한 속성 접근 필요
  - [F-057] Peer 캐스팅 오류: 딕셔너리를 Telethon 엔티티로 캐스팅 시도
  - [F-058] title 변수 스코프 오류 완전 해결: test_channel_access 함수에서 누락된 수정
ADD HYPOTHESES:
  - [H-016] 모든 메시지 수신 후 내부 필터링으로 메시지 누락 0% 달성 가능
  - [H-017] 실시간 연결 상태 모니터링으로 안정성 향상
  - [H-018] 상세한 디버깅 로그로 메시지 처리 과정 100% 추적 가능
  - [H-019] 링크 처리 에러 수정으로 웹페이지 콘텐츠 분석 100% 성공률 달성 가능
  - [H-020] 이미지 OCR 텍스트 통합 분석으로 중요도 판단 정확도 향상
  - [H-021] 무의미한 메시지 필터링으로 노이즈 감소 및 가독성 향상
  - [H-022] 중요도 분류 강화로 이벤트/폼 링크 우선순위 부여 가능
  - [H-023] Upstage.ai 임베딩 기반 중복 제거로 의미적 유사도 정확도 향상
  - [H-024] 코사인 유사도 계산으로 SimHash 대비 더 정확한 중복 감지 가능
  - [H-025] 일자별 로그 디렉터리로 로그 관리 효율성 향상
  - [H-026] 돈 버는 정보 분석으로 실용적 가치 제공
  - [H-027] 로그 레벨 조정으로 노이즈 감소 및 가독성 향상
  - [H-028] 전송된 메시지 전용 로그로 분석 및 추적 효율성 향상
  - [H-029] 일자별 로그 디렉터리로 로그 관리 체계화
  - [H-030] normalize_text 함수 참조 제거로 메시지 처리 안정성 확보
  - [H-031] API 연결 테스트 및 대체 로직으로 임베딩 실패 시 안정성 확보
  - [H-032] solar-embedding-1-mini 모델로 안정적인 임베딩 생성 가능
  - [H-033] 안전한 변수 접근으로 폴링 시스템 안정성 확보
  - [H-034] 엔티티 캐시 분리로 Peer 캐스팅 오류 해결 및 성능 향상
  - [H-035] AST 분석을 통한 title 변수 스코프 문제 완전 해결
ADD EXPERIMENTS:
  - [E-070] app/formatter.py: 정의 순서 수정 — title/body/link를 스타일 적용 전에 escape하여 변수 초기화
  - [E-071] Playwright 통합 테스트: OpenSea URL 렌더링 성공 — 제목 "GAIB Fremen Essence NFT - Collection | OpenSea", 콘텐츠 1000자 추출
  - [E-072] 돈버는 정보 메시지 저장 시스템 테스트: money_message_processor.py 정상 작동, 통계 조회 기능 확인
  - [E-073] 중요 채널 설정 테스트: IMPORTANT_CHANNEL 환경변수 정상 로드, @arang_summary_important 설정 확인
  - [E-074] 에러 수정 테스트: None 텍스트 처리, 이미지 처리 안정성, 링크 포함 전송 기능 확인
  - [E-075] 봇 개인 알림 테스트: 개인 chat_id 5880009620 확보, 봇 API 테스트 메시지 전송 성공
  - [E-076] date_ts 에러 수정: now_ts 변수 사용으로 수정, update_analysis 누락 인자 추가
  - [E-077] 내용 없는 요약 필터링 구현: 10개 패턴으로 무의미한 요약 차단, 전송 전 필터링
  - [E-078] 이미지 처리 안정성 강화: 대용량 이미지 리사이즈, 이미지 검증 로직 개선
  - [E-079] 봇 개인 DM 알림 개선: 요약 자르기 제거, 전체 요약 전송
  - [E-080] 링크 추출 및 표시 개선: 포괄적인 URL 패턴 매칭, 클릭 가능한 링크 표시
  - [E-081] 봇 개인 DM 알림 포매팅 개선: 채널과 동일한 포매팅 적용, 원문 링크 및 포함된 링크 표시
  - [E-082] 원문 열기 링크 오류 수정: 변수명 충돌 해결, 원문 링크와 포함된 링크 구분
  - [E-083] 중요 봇 알림 시스템 구현: IMPORTANT_BOT_TOKEN 설정, medium 이상 + 돈버는 정보 메시지 분리 전송
  - [E-084] 메시지 중복 처리 해결: 이벤트 리스너 제거, 폴링 방식만 사용하여 중복 처리 방지
  - [E-085] 이벤트 상품 정보 표시 기능 구현: LLM 분석에 event_products 필드 추가, 포매터에 표시 기능 구현
  - [E-086] 포워딩 메시지 중복 제거 강화: 텍스트 해시 기반 정확한 중복 제거, 2단계 중복 제거 시스템 구현
  - [E-087] 프로그램 재시작 시 중복 처리 방지: 데이터베이스 기반 메시지 처리 상태 추적, 폴링 방식 개선
  - [E-030] app/run.py:580 chats 파라미터 제거 — 모든 메시지 수신
  - [E-031] app/run.py:585-590 연결 상태 확인 로깅 추가
  - [E-032] app/run.py:200-205 모든 메시지 기본 로깅 추가
  - [E-033] 봇 재시작 및 연결 상태 확인 — 정상 작동 확인
  - [E-034] app/link_processor.py:42 timeout 키워드 인자 수정 — 링크 처리 에러 해결
  - [E-035] app/run.py:350-360 이미지 OCR 텍스트 통합 분석 개선
  - [E-036] app/run.py:520-530 무의미한 메시지 필터링 패턴 추가
  - [E-037] app/rules.py:15-25 중요 링크 패턴 추가 및 부스팅 로직 강화
  - [E-038] app/formatter.py:45-55 중요도별 스타일 적용으로 가독성 향상
  - [E-039] app/embedding_client.py 신규 생성 — Upstage.ai 임베딩 클라이언트 구현
  - [E-040] app/config.py:15-20 Upstage API 키 및 유사도 임계값 설정 추가
  - [E-041] app/storage.py:50-90 데이터베이스 스키마 마이그레이션 (simhash → embedding)
  - [E-042] app/run.py:400-420 임베딩 기반 중복 제거 로직으로 교체
  - [E-043] app/storage.py:10 logger 정의 추가 — NameError 해결
  - [E-044] app/logging_utils.py:15-80 일자별 로그 디렉터리 및 로테이션 구현
  - [E-045] app/llm.py:20-30 돈 버는 정보 및 행동 가이드 분석 추가
  - [E-046] app/storage.py:50-90 데이터베이스 스키마 마이그레이션 (money_making_info, action_guide)
  - [E-047] app/formatter.py:60-70 돈 버는 정보 표시 기능 추가
  - [E-048] app/run.py:223 dedup_hamming_threshold → dedup_similarity_threshold 속성명 변경
  - [E-049] app/logging_utils.py:85-105 전송된 메시지 전용 로거 설정 추가
  - [E-050] app/sent_message_logger.py 신규 생성 — 전송된 메시지 로깅 클래스 구현
  - [E-051] app/run.py:585-600 전송된 메시지 로깅 통합
  - [E-052] app/run.py:344-348 normalize_text 함수 참조 제거 — strip()으로 대체
  - [E-053] app/dedup.py:1-31 파일 정리 — 하위 호환성을 위해 함수 유지하되 기능 제거
  - [E-054] app/embedding_client.py:25-75 API 요청 형식 개선 — 텍스트 길이 제한, 에러 처리 강화
  - [E-055] app/embedding_client.py:85-95 API 연결 테스트 함수 추가
  - [E-056] app/run.py:125-130 앱 시작 시 API 연결 테스트 통합
  - [E-057] app/run.py:410-425 임베딩 실패 시 대체 로직 구현 — 중복 제거 없이 처리 계속
  - [E-058] app/embedding_client.py:35 모델명 수정 — solar-embedding-1-mini로 변경
  - [E-059] Python 캐시 정리 — __pycache__ 및 .pyc 파일 제거
  - [E-060] API 연결 테스트 스크립트 실행 — 4096차원 벡터 정상 생성 확인
  - [E-061] app/run.py:695-720 폴링 메시지 처리 안전성 강화 — 변수 스코프 문제 해결
  - [E-062] app/run.py:685-690 채널 정보 캐시 활용 — 성능 개선 및 안정성 향상
  - [E-063] app/run.py:155-160 엔티티 캐시 분리 — 메타데이터와 엔티티 캐시 분리
  - [E-064] app/run.py:690-700 엔티티 캐시 활용 — Peer 캐스팅 오류 해결
  - [E-065] app/run.py:210-220 초기 엔티티 로딩 — 시작 시 엔티티 미리 로딩
  - [E-066] app/run.py:160-170 캐시 정리 함수 — 메모리 관리 및 성능 최적화
  - [E-067] app/run.py:676-686 test_channel_access 함수 title 변수 수정 — 안전한 속성 접근
  - [E-068] Python 캐시 완전 정리 — 구버전 코드 실행 방지
  - [E-069] AST 분석을 통한 title 변수 검증 — 모든 변수 사용 안전성 확인
ADD DECISIONS:
  - [D-054] 포매터 안전성 강화 — 모든 의존 변수(title/body/link) 선초기화 후 사용
  - [D-055] Playwright 기반 렌더링 채택 — requests 대신 브라우저 렌더링으로 403 우회 및 JS 실행 지원
  - [D-056] 돈버는 정보 메시지 별도 저장 채택 — 원문/포워딩/이미지 경로 포함하여 후속 처리 가능
  - [D-057] 중요 채널 중복 전송 채택 — 돈버는 정보 또는 high 중요도 메시지를 별도 채널로 중복 전송하여 가시성 향상
  - [D-058] 에러 처리 강화 채택 — None 텍스트, 이미지 처리, 링크 포함 전송 등 안정성 개선
  - [D-059] 봇 개인 알림 채택 — 모든 전송된 메시지에 대해 개인 DM으로 알림 전송
  - [D-060] 변수명 통일 채택 — date_ts → now_ts 변수 사용, update_analysis 메서드 호출 시 모든 필수 인자 포함
  - [D-061] 내용 없는 요약 필터링 채택 — 무의미한 요약 메시지 전송 방지로 품질 향상
  - [D-062] 이미지 처리 안정성 강화 채택 — 대용량 이미지 리사이즈, 검증 로직 개선
  - [D-063] 봇 개인 DM 알림 개선 채택 — 전체 요약 전송으로 정보 완전성 확보
  - [D-064] 링크 추출 및 표시 개선 채택 — 포괄적인 URL 패턴, 클릭 가능한 링크 표시
  - [D-065] 봇 개인 DM 알림 포매팅 통일 채택 — 채널과 동일한 포매팅으로 정보 완전성 확보
  - [D-066] 원문 링크 변수명 분리 채택 — original_link_escaped 변수로 원문 링크와 포함된 링크 구분
  - [D-067] 중요 봇 분리 전송 채택 — medium 이상 + 돈버는 정보 메시지를 별도 봇으로 분리하여 중요도별 알림
  - [D-068] 폴링 방식 단일 사용 채택 — 이벤트 리스너 제거로 메시지 중복 처리 방지
  - [D-069] 이벤트 상품 정보 표시 채택 — 이벤트/에어드랍/프로모션 메시지에 상품/보상 정보 표시 기능 추가
  - [D-070] 포워딩 메시지 중복 제거 강화 채택 — 텍스트 해시 기반 정확한 중복 제거, 2단계 중복 제거 시스템
  - [D-071] 프로그램 재시작 시 중복 처리 방지 채택 — 데이터베이스 기반 메시지 처리 상태 추적, 효율적인 폴링 방식
  - [D-032] Telethon 이벤트 핸들러 제한 우회 — 내부 필터링 방식 채택
  - [D-033] 연결 상태 실시간 모니터링 — 5분마다 연결 상태 확인
  - [D-034] 모든 메시지 기본 로깅 — 디버깅 및 추적 강화
  - [D-035] 안정성 우선 접근 — 메시지 누락 방지
  - [D-036] 링크 처리 에러 수정 — timeout 키워드 인자 사용으로 안정성 확보
  - [D-037] 이미지 OCR 텍스트 통합 분석 — 중요도 판단 정확도 향상
  - [D-038] 무의미한 메시지 필터링 — 정규식 패턴으로 노이즈 차단
  - [D-039] 중요도 분류 강화 — 이벤트/폼/오픈채팅방 링크 우선순위 부여
  - [D-040] 가독성 개선 — 중요도별 이모지와 스타일 적용
  - [D-041] SimHash → Upstage.ai 임베딩 교체 — 의미적 유사도 기반 중복 제거
  - [D-042] 코사인 유사도 임계값 설정 — 0.85 기본값으로 정확도와 성능 균형
  - [D-043] 데이터베이스 스키마 마이그레이션 — 기존 simhash 컬럼을 embedding으로 변경
  - [D-044] 로그 시스템 개선 — 일자별 디렉터리, 로테이션, 레벨 조정
  - [D-045] LLM 분석 강화 — 돈 버는 정보 및 행동 가이드 추가
  - [D-046] LangChain 도입 검토 — 현재 구조 유지 결정 (오버엔지니어링 방지)
  - [D-047] 전송된 메시지 전용 로그 시스템 — 분석 및 추적 효율성 향상
  - [D-048] 일자별 로그 디렉터리 구조 — 로그 관리 체계화
  - [D-049] normalize_text 함수 참조 제거 — SimHash 제거 시 누락된 참조 해결
  - [D-050] Upstage.ai API 에러 처리 강화 — 요청 형식 개선 및 대체 로직 구현
  - [D-051] 폴링 시스템 안전성 강화 — 변수 스코프 문제 해결 및 캐시 활용
  - [D-052] 엔티티 캐시 분리 — 메타데이터와 엔티티 캐시 분리로 Peer 캐스팅 오류 해결
  - [D-053] title 변수 스코프 문제 완전 해결 — 모든 title 변수 사용을 안전한 방식으로 수정
ADD AUDIT_LOG:
  - 2025-08-21T20:04+09:00: app/formatter.py 수정 적용 — UnboundLocalError 해결 및 린트 통과
  - 2025-08-21T20:15+09:00: Playwright 통합 완료 — app/link_processor.py 리팩터링, OpenSea 403 우회 성공
  - 2025-08-21T20:25+09:00: 돈버는 정보 메시지 별도 저장 시스템 구현 — money_messages 테이블, 저장 로직, 처리 유틸리티 추가
  - 2025-08-21T20:35+09:00: 중요 채널 중복 전송 시스템 구현 — IMPORTANT_CHANNEL 설정, 돈버는 정보/high 중요도 메시지 중복 전송 로직 추가
  - 2025-08-21T20:45+09:00: 에러 수정 및 링크 포함 전송 구현 — None 텍스트 처리, 이미지 처리 안정성, 링크 포함 전송 기능 추가
  - 2025-08-21T20:55+09:00: 봇 개인 DM 알림 시스템 구현 — BotNotifier 클래스, 개인 chat_id 확보, 봇 API 통합
  - 2025-08-21T21:00+09:00: date_ts 변수 에러 수정 — now_ts 변수 사용, update_analysis 메서드 누락 인자 추가
  - 2025-08-21T21:40+09:00: 내용 없는 요약 필터링, 이미지 처리 안정성 강화, 봇 개인 DM 알림 개선
  - 2025-08-21T21:45+09:00: 링크 추출 및 표시 개선 — 포괄적인 URL 패턴, 클릭 가능한 링크 표시
  - 2025-08-21T21:50+09:00: 봇 개인 DM 알림 포매팅 개선 — 채널과 동일한 포매팅 적용
  - 2025-08-21T21:55+09:00: 원문 열기 링크 오류 수정, 중요 봇 알림 시스템 구현
  - 2025-08-21T22:00+09:00: 메시지 중복 처리 해결 — 이벤트 리스너 제거, 폴링 방식 단일 사용
  - 2025-08-21T22:05+09:00: 이벤트 상품 정보 표시 기능 구현 완료
  - 2025-08-21T22:10+09:00: 포워딩 메시지 중복 제거 강화 완료
  - 2025-08-21T22:15+09:00: 프로그램 재시작 시 중복 처리 방지 완료
  - 2025-08-21T14:40+09:00: Telethon 이벤트 핸들러 제한 발견
  - 2025-08-21T14:41+09:00: app/run.py chats 파라미터 제거
  - 2025-08-21T14:42+09:00: 모든 메시지 기본 로깅 추가
  - 2025-08-21T14:43+09:00: 연결 상태 확인 로깅 추가
  - 2025-08-21T14:45+09:00: 봇 재시작 및 정상 작동 확인
  - 2025-08-21T16:15+09:00: 링크 처리 에러 수정 (Session.get() timeout 인자)
  - 2025-08-21T16:16+09:00: 이미지 OCR 텍스트 통합 분석 개선
  - 2025-08-21T16:17+09:00: 무의미한 메시지 필터링 강화
  - 2025-08-21T16:18+09:00: 중요도 분류 강화 (이벤트/폼/오픈채팅방 링크)
  - 2025-08-21T16:19+09:00: 메시지 포맷팅 가독성 개선
  - 2025-08-21T16:30+09:00: Upstage.ai 임베딩 클라이언트 생성
  - 2025-08-21T16:31+09:00: 설정에 Upstage API 키 및 유사도 임계값 추가
  - 2025-08-21T16:32+09:00: 데이터베이스 스키마 마이그레이션 (simhash → embedding)
  - 2025-08-21T16:33+09:00: 임베딩 기반 중복 제거 로직 구현
  - 2025-08-21T16:34+09:00: 의존성 업데이트 (simhash 제거, numpy 추가)
  - 2025-08-21T16:35+09:00: storage.py logger 정의 추가 (NameError 해결)
  - 2025-08-21T16:36+09:00: 로그 시스템 개선 (일자별 디렉터리, 로테이션)
  - 2025-08-21T16:37+09:00: LLM 분석 강화 (돈 버는 정보, 행동 가이드)
  - 2025-08-21T16:38+09:00: 데이터베이스 스키마 마이그레이션 (새 컬럼 추가)
  - 2025-08-21T16:39+09:00: 포맷터 업데이트 (돈 버는 정보 표시)
  - 2025-08-21T16:40+09:00: LangChain 활용 검토 (현재 구조 유지 결정)
  - 2025-08-21T16:41+09:00: dedup_hamming_threshold 속성명 변경 (에러 해결)
  - 2025-08-21T16:42+09:00: 전송된 메시지 전용 로그 시스템 구현
  - 2025-08-21T16:43+09:00: 일자별 로그 디렉터리 구조 적용
  - 2025-08-21T16:44+09:00: README 로깅 섹션 업데이트
  - 2025-08-21T16:45+09:00: normalize_text 함수 참조 제거 (에러 해결)
  - 2025-08-21T16:46+09:00: app/dedup.py 파일 정리 (하위 호환성 유지)
  - 2025-08-21T16:47+09:00: Upstage.ai API 400 에러 해결 (요청 형식 개선)
  - 2025-08-21T16:48+09:00: 임베딩 실패 시 대체 로직 구현 (안정성 향상)
  - 2025-08-21T16:49+09:00: Upstage.ai 모델명 수정 (solar-embedding-1-mini)
  - 2025-08-21T16:50+09:00: Python 캐시 정리 (simhash_value 참조 오류 해결)
  - 2025-08-21T16:51+09:00: API 연결 테스트 성공 (4096차원 벡터 생성 확인)
  - 2025-08-21T16:52+09:00: 폴링 메시지 처리 title 변수 스코프 오류 해결
  - 2025-08-21T16:53+09:00: 채널 정보 캐시 활용으로 성능 개선
  - 2025-08-21T16:54+09:00: Peer 캐스팅 오류 해결 (엔티티 캐시 분리)
  - 2025-08-21T16:55+09:00: 캐시 메모리 관리 시스템 구현
  - 2025-08-21T16:56+09:00: title 변수 스코프 문제 완전 해결 (AST 분석 검증)
  - 2025-08-21T16:57+09:00: Python 캐시 완전 정리 (구버전 코드 실행 방지)
TODO:
  - [T-031] 메시지 처리 성능 최적화 (대용량 처리 대비)
  - [T-032] 채널별 개별 핸들러 방식 검토
  - [T-033] 배치 처리 시스템 구현
  - [T-034] 머신러닝 기반 메시지 분류 시스템 구현
  - [T-035] 채널별 중요도 설정 기능 추가
OPEN_QUESTIONS:
  - [Q-020] 모든 메시지 처리 시 성능 영향 평가
  - [Q-021] 채널별 개별 핸들러 vs 전체 핸들러 성능 비교
  - [Q-022] 무의미한 메시지 필터링 패턴 최적화
  - [Q-023] 중요도 부스팅 알고리즘 정확도 평가
  - [Q-024] 임베딩 API 호출 지연으로 인한 처리 속도 영향 평가
  - [Q-025] 코사인 유사도 임계값 최적화 (0.85 vs 0.90 vs 0.80)
  - [Q-026] 벡터 데이터베이스 도입 필요성 검토 (대규모 유사도 검색)
  - [Q-027] 로그 압축 및 아카이브 시스템 도입 필요성
  - [Q-028] LLM 분석 배치 처리 최적화 방안
  - [Q-029] 웹 대시보드 시스템 도입 검토
  - [Q-030] 전송된 메시지 통계 분석 시스템 도입 검토
  - [Q-031] 로그 압축 및 아카이브 자동화 시스템 도입 검토
  - [Q-032] 텍스트 전처리 파이프라인 도입 검토 (정규화 수준 향상)
  - [Q-033] 로컬 임베딩 모델 도입 검토 (API 의존성 제거)
  - [Q-034] 다중 임베딩 모델 지원 검토 (성능 비교 및 자동 선택)
  - [Q-035] 캐시 성능 최적화 검토 (TTL, 히트율 분석, 지연 로딩)
  - [Q-036] 코드 품질 모니터링 시스템 도입 검토 (정적 분석, 자동화된 검증)

# === END ===


